1
00:00:00,506 --> 00:00:04,500
[音乐]


2
00:00:11,176 --> 00:00:13,196
>> 大家下午好


3
00:00:13,306 --> 00:00:16,335
欢迎来到我们的讲演


4
00:00:16,335 --> 00:00:17,236
Working with USD（使用 USD）


5
00:00:17,926 --> 00:00:19,186
很高兴来到这儿


6
00:00:19,926 --> 00:00:21,386
我叫 Denis Kovacs


7
00:00:21,386 --> 00:00:23,486
一会 Chloe Moore 会加入讲演


8
00:00:24,436 --> 00:00:26,316
去年 我们介绍了 


9
00:00:26,316 --> 00:00:27,536
iOS 上的 AR Quick Look


10
00:00:27,976 --> 00:00:30,266
这是在设备上


11
00:00:30,266 --> 00:00:32,906
探索 AR 中 3D 内容的最简单方法


12
00:00:35,476 --> 00:00:37,806
比如 你可以查看


13
00:00:37,806 --> 00:00:39,476
你想购买的产品的模型


14
00:00:40,066 --> 00:00:41,026
你可以把它放在 


15
00:00:41,026 --> 00:00:42,676
自己所处的地方


16
00:00:42,676 --> 00:00:43,486
感受它的真实大小


17
00:00:44,666 --> 00:00:45,966
当你移动设备时 


18
00:00:46,256 --> 00:00:47,976
模型牢牢锁定在你周围


19
00:00:51,966 --> 00:00:53,316
你可以感受到   


20
00:00:53,316 --> 00:00:54,686
在自己家里


21
00:00:55,106 --> 00:00:56,566
实物看起来是什么样子的


22
00:00:56,896 --> 00:00:58,586
因为模型的制作


23
00:00:58,586 --> 00:01:00,056
是依据你所处地的照明情况的


24
00:01:01,106 --> 00:01:02,346
发光材料 


25
00:01:02,346 --> 00:01:03,416
比如 这盏灯上的抛光铬


26
00:01:03,916 --> 00:01:05,226
甚至可以反射你的环境


27
00:01:08,776 --> 00:01:10,706
AR 就是很好玩


28
00:01:11,576 --> 00:01:13,246
它真的非常直观


29
00:01:13,246 --> 00:01:15,066
可以用来探索 3D 内容


30
00:01:15,066 --> 00:01:15,976
并与之互动


31
00:01:21,286 --> 00:01:22,566
在这些所有的 AR 体验背后 


32
00:01:22,566 --> 00:01:24,586
是一个文件格式 USDZ


33
00:01:24,586 --> 00:01:27,976
我们去年将其引入平台


34
00:01:30,306 --> 00:01:32,556
USDZ 支持已经


35
00:01:32,556 --> 00:01:34,026
和我们的 App 和框架融为一体


36
00:01:34,026 --> 00:01:36,096
所以你可以通过


37
00:01:36,096 --> 00:01:37,316
信息和邮箱 


38
00:01:37,316 --> 00:01:39,776
把你的 AR 体验分享给朋友


39
00:01:39,776 --> 00:01:41,766
你可以在 AR 里体验交互新闻


40
00:01:41,766 --> 00:01:44,336
新闻内容焕然一新


41
00:01:44,336 --> 00:01:45,676
你或许还可以用一种全新的方式体验 web


42
00:01:45,676 --> 00:01:47,636
通过 Safari


43
00:01:47,636 --> 00:01:48,986
直接将它们带入 AR 


44
00:01:50,246 --> 00:01:53,226
你可以借用 USDZ 


45
00:01:53,226 --> 00:01:54,456
搭建自己的 App


46
00:01:59,236 --> 00:02:02,496
USDZ 背后的技术是 USD


47
00:02:02,496 --> 00:02:05,596
这就是我们这次讲演的主题


48
00:02:09,096 --> 00:02:11,816
这是我们今天的议程


49
00:02:12,386 --> 00:02:14,256
首先 我们要看一下 USD 是什么


50
00:02:14,256 --> 00:02:16,776
然后我们会讨论一些工作流


51
00:02:16,776 --> 00:02:18,186
这些工作流


52
00:02:18,236 --> 00:02:20,426
和创建 转化 USDZ 有关


53
00:02:20,576 --> 00:02:22,066
最后 我们会帮你形成 


54
00:02:22,066 --> 00:02:24,496
使用 USD 的思维直觉


55
00:02:25,556 --> 00:02:26,966
我们开始会介绍一些要素


56
00:02:27,036 --> 00:02:28,716
它们对于大部分 3D 文件格式来说都很常见


57
00:02:29,496 --> 00:02:30,636
最后我们会介绍


58
00:02:30,636 --> 00:02:33,906
USD 一些独有的功能


59
00:02:34,176 --> 00:02:34,976
首先 什么是 USD


60
00:02:38,206 --> 00:02:40,786
USD 的全称是 Universal Scene Description


61
00:02:42,086 --> 00:02:44,496
它是一个 3D 文件格式


62
00:02:44,726 --> 00:02:46,856
通过 Python 绑定支持 C++ 库


63
00:02:46,856 --> 00:02:49,666
是由 Pixar 开发的 


64
00:02:50,616 --> 00:02:53,516
这个库可以读写 


65
00:02:54,236 --> 00:02:55,606
USD 文件


66
00:02:55,786 --> 00:02:58,846
它有一个非常好用的创作引擎 


67
00:02:58,916 --> 00:02:59,476
当然远不止这些


68
00:03:00,186 --> 00:03:02,416
这个库的重点是速度 


69
00:03:02,416 --> 00:03:06,406
可扩展性 以及合作


70
00:03:07,196 --> 00:03:08,546
这是 USD 的三个扩展文件


71
00:03:08,836 --> 00:03:10,766
一个是纯文字版本 USDA 


72
00:03:10,766 --> 00:03:12,546
它的设计初衷


73
00:03:12,976 --> 00:03:16,496
是让读写


74
00:03:16,856 --> 00:03:19,156
尽可能简单


75
00:03:20,006 --> 00:03:22,656
第二个是二进制版本 USDC


76
00:03:22,746 --> 00:03:25,456
优点是尽可能高效读写


77
00:03:26,176 --> 00:03:28,566
第三个是 USD


78
00:03:28,566 --> 00:03:30,716
它既可以是纯文本也可以是二进制


79
00:03:31,336 --> 00:03:33,856
你可以在这些文件格式中


80
00:03:33,856 --> 00:03:34,976
来回转换


81
00:03:38,386 --> 00:03:40,656
这个是 USDZ 


82
00:03:41,636 --> 00:03:45,126
我们先来仔细讲解一下这个格式


83
00:03:45,246 --> 00:03:47,216
什么是 USDZ


84
00:03:47,216 --> 00:03:49,456
USDZ 是 USD 的分发格式


85
00:03:50,216 --> 00:03:51,766
它包含一个 3D 场景的所有数据


86
00:03:51,766 --> 00:03:55,366
打包在单个压缩文件中


87
00:03:56,666 --> 00:03:58,406
它是为共享而优化的


88
00:03:58,406 --> 00:04:00,476
是 AR Quick Look 的基础


89
00:04:00,986 --> 00:04:04,216
iOS macOS 和 tvOS 


90
00:04:04,216 --> 00:04:04,496
都支持 USDZ


91
00:04:04,496 --> 00:04:08,966
如果剖析一下 USDZ 文件


92
00:04:09,286 --> 00:04:10,336
就可以看到  


93
00:04:10,336 --> 00:04:13,176
它是一个未压缩 zip 存档


94
00:04:13,176 --> 00:04:15,076
为了最有效的内存映射


95
00:04:15,076 --> 00:04:17,696
内含的所有文件


96
00:04:18,315 --> 00:04:20,565
都对齐 64 位边界


97
00:04:21,966 --> 00:04:23,906
这是 USDZ 存档


98
00:04:23,906 --> 00:04:28,296
包含的两种文件类型场景描述


99
00:04:28,626 --> 00:04:33,316
以 USDA USD 或 USDC 甚至 USDZ 格式归档


100
00:04:33,316 --> 00:04:34,916
所以你有嵌套存档


101
00:04:35,016 --> 00:04:37,866
以及一套纹理


102
00:04:38,266 --> 00:04:40,906
目前是 PNG 或 JPEG 格式


103
00:04:46,826 --> 00:04:49,036
我们粗略比较一下


104
00:04:49,366 --> 00:04:52,726
目前那些文件格式


105
00:04:52,926 --> 00:04:54,416
基础的 最基础的格式是 obj


106
00:04:54,416 --> 00:04:58,206
包含一个简单的 3D 模型


107
00:04:59,346 --> 00:05:00,926
材料支持有限


108
00:05:00,926 --> 00:05:03,066
没有动画


109
00:05:03,626 --> 00:05:06,806
这些是一批与之不同的 


110
00:05:06,876 --> 00:05:09,226
更现代的文件格式


111
00:05:09,736 --> 00:05:11,056
它们通常包含多个模型  


112
00:05:11,056 --> 00:05:15,056
可以布局在一个场景图中


113
00:05:15,056 --> 00:05:16,546
它们支持不同的


114
00:05:17,066 --> 00:05:20,176
材料描述和动画


115
00:05:22,376 --> 00:05:25,026
USD支持所有的这些


116
00:05:25,666 --> 00:05:27,646
但是它的附加优点是 可扩展


117
00:05:27,646 --> 00:05:29,556
Pixar 为更大的电影场景 


118
00:05:29,556 --> 00:05:31,176
发明了这个格式


119
00:05:31,956 --> 00:05:33,566
它还支持多人合作


120
00:05:33,626 --> 00:05:35,396
让很多美术师 


121
00:05:35,396 --> 00:05:37,196
在一个场景一起工作


122
00:05:37,196 --> 00:05:39,266
同时又不会干扰彼此工作


123
00:05:44,186 --> 00:05:46,926
USDZ 是一个存档包 


124
00:05:47,676 --> 00:05:49,556
也承袭了大部分这些功能


125
00:05:53,296 --> 00:05:56,106
接下来 我们看一下工作流


126
00:05:56,686 --> 00:05:59,466
我们可以把这些分为两类


127
00:05:59,466 --> 00:06:02,196
转换已有素材 


128
00:06:02,196 --> 00:06:04,636
和创建新素材


129
00:06:05,206 --> 00:06:08,966
我们先从转换已有素材开始


130
00:06:13,486 --> 00:06:16,046
想象一下你有这个的素材   


131
00:06:16,116 --> 00:06:18,526
是一些其他的格式


132
00:06:18,526 --> 00:06:20,316
可能是 FBX 或 gltf


133
00:06:20,316 --> 00:06:22,416
想要将它们


134
00:06:22,416 --> 00:06:24,886
转换为USDZ 


135
00:06:24,886 --> 00:06:28,546
应用到 App 或 AR Quick Look 上去


136
00:06:31,216 --> 00:06:33,016
今天我们介绍了一个 


137
00:06:33,016 --> 00:06:34,506
新命令行工具


138
00:06:34,506 --> 00:06:35,386
叫作 USDZconvert 


139
00:06:36,106 --> 00:06:37,996
它超越了去年的 Xcode converter


140
00:06:37,996 --> 00:06:41,566 
让你可以转换


141
00:06:41,566 --> 00:06:43,646
更多的文件格式 


142
00:06:43,716 --> 00:06:46,676
比如 FBX 和 gltf


143
00:06:47,086 --> 00:06:48,886
它还可以执行素材验证


144
00:06:49,546 --> 00:06:50,606
所以你可以确信


145
00:06:50,606 --> 00:06:52,086
生成的 USDZ 文件


146
00:06:52,086 --> 00:06:52,906
没有问题


147
00:06:53,696 --> 00:06:56,746
而且它搭建在 Python 上


148
00:06:56,776 --> 00:06:57,756
所以不受平台限制


149
00:06:58,506 --> 00:06:59,486
在 macOS 的其他平台上  


150
00:06:59,486 --> 00:07:02,306
将这个转换器


151
00:07:02,306 --> 00:07:05,176
和你的现有内容流程相结合


152
00:07:05,456 --> 00:07:06,956
就会比较简单


153
00:07:11,216 --> 00:07:12,656
这里有几个样本案例


154
00:07:13,016 --> 00:07:14,686
比如说你有一个 gltf 文件


155
00:07:14,686 --> 00:07:16,386
你可以用 USDZconvert 


156
00:07:16,386 --> 00:07:18,796
把这个文件转换为 USDZ 格式


157
00:07:18,796 --> 00:07:21,496
你可以看到 


158
00:07:21,556 --> 00:07:22,976
它之后执行了素材验证


159
00:07:26,736 --> 00:07:28,006
如果你想知道 


160
00:07:28,006 --> 00:07:29,586
所有的命令行选项


161
00:07:29,636 --> 00:07:30,466
你可以使用这个 -h


162
00:07:31,116 --> 00:07:38,416
你也可以直接从命令行


163
00:07:38,416 --> 00:07:39,276
提供丰富的材料描述


164
00:07:39,276 --> 00:07:41,056
尤其对于 obj 这种   


165
00:07:41,056 --> 00:07:42,356
没有丰富材料定义的文件格式


166
00:07:42,646 --> 00:07:45,096
这就非常方便


167
00:07:47,556 --> 00:07:50,366
Usdzconvert只是其中一部分 


168
00:07:50,366 --> 00:07:52,806
我们对开发者提供了更大的包


169
00:07:53,496 --> 00:07:55,286
这个包还包括


170
00:07:55,376 --> 00:07:57,186
为 macOS 预编译的二进制 USD 库


171
00:07:57,186 --> 00:07:59,626
还有一些其他东西


172
00:07:59,836 --> 00:08:05,056
比如 USD 命令行工具


173
00:08:05,266 --> 00:08:08,696
比如 Usdcat 


174
00:08:09,156 --> 00:08:10,656
它可以将你的 USDZ 文件


175
00:08:10,656 --> 00:08:14,946
输出为纯文本


176
00:08:15,106 --> 00:08:17,416
Usdtree 可以用来查看


177
00:08:17,416 --> 00:08:19,786
模型层次的高级结构


178
00:08:20,896 --> 00:08:25,616
USDchecker 是 USDZ 素材的验证器


179
00:08:26,196 --> 00:08:29,726
我们还有一个小脚本


180
00:08:29,726 --> 00:08:31,266
叫作 固定容量


181
00:08:31,776 --> 00:08:33,086
去年 如果你提供透明材料的模型


182
00:08:33,086 --> 00:08:34,525 
给 AR Quick Look 


183
00:08:34,576 --> 00:08:36,446
那些材料在 iOS 13 里


184
00:08:36,446 --> 00:08:38,746
是看起来是不透明的


185
00:08:38,946 --> 00:08:43,576
用脚本来解决这个问题


186
00:08:43,726 --> 00:08:45,576
为了演示一下这些


187
00:08:45,576 --> 00:08:47,776
我想邀请 Chloe 到台上来


188
00:08:48,516 --> 00:08:53,746
[掌声]


189
00:08:54,246 --> 00:08:54,996
>> 谢谢你 Denis


190
00:08:55,976 --> 00:08:57,706
正如之前所见


191
00:08:57,706 --> 00:09:00,056
我们提供了预编译的 USD Python 库


192
00:09:00,056 --> 00:09:02,466
可以在这里下载


193
00:09:03,606 --> 00:09:05,916
我已经下载并解压了


194
00:09:07,266 --> 00:09:08,976
USD 文件夹包括


195
00:09:08,976 --> 00:09:10,886
预编译的 USD Python 库


196
00:09:11,206 --> 00:09:12,876
和一系列命令行工具


197
00:09:12,876 --> 00:09:15,246
比如 Pixar 提供的


198
00:09:15,246 --> 00:09:16,906
USDtree 和 USDcat 


199
00:09:18,296 --> 00:09:20,586
USDZconvert 文件夹包含


200
00:09:20,586 --> 00:09:22,566
USDZconvert 工具


201
00:09:22,566 --> 00:09:23,326
和解决不透明的工具


202
00:09:24,536 --> 00:09:26,276
我们还提供了 USD 命令


203
00:09:26,536 --> 00:09:28,746
它可以为你设置一些环境变量


204
00:09:28,746 --> 00:09:31,316
当你双击时 它打开了一个


205
00:09:31,316 --> 00:09:31,976
终端窗口


206
00:09:36,176 --> 00:09:38,226
我们先从 USDZconvert 开始


207
00:09:39,026 --> 00:09:40,816
如果你只是单纯运行 USDZconvert


208
00:09:40,816 --> 00:09:43,476
它就输出我们的参数


209
00:09:44,966 --> 00:09:46,596
现在想象你有某个 gltf 文件


210
00:09:46,596 --> 00:09:47,736
需要转换


211
00:10:03,346 --> 00:10:05,956
你可以用你的文件名 简单地运行 USDZconvert


212
00:10:06,316 --> 00:10:09,926
现在 我们来看一下生成素材


213
00:10:11,256 --> 00:10:13,216
生成到文件


214
00:10:13,216 --> 00:10:15,416
包含所有的材料和动画


215
00:10:18,936 --> 00:10:21,996
这儿我们也可以看到 


216
00:10:21,996 --> 00:10:23,976
USDZconvert 执行了附加的素材验证


217
00:10:27,566 --> 00:10:29,116
接下来 比如说 


218
00:10:29,116 --> 00:10:31,326
你有某个没有材料的 obj 文件


219
00:10:31,896 --> 00:10:32,976
就像这个四面体模型


220
00:10:36,706 --> 00:10:38,316
你可以用附加参数


221
00:10:38,536 --> 00:10:40,056
简单地添加材料 


222
00:10:40,056 --> 00:10:40,966
比如 常量颜色


223
00:10:45,246 --> 00:10:46,966
这里你可以看到 材料被应用了


224
00:10:51,796 --> 00:10:53,496
要看你模型的高级结构 


225
00:10:53,496 --> 00:10:56,546
你可以使用 USDtree


226
00:10:58,096 --> 00:11:01,276
这里是材料和网格


227
00:11:05,236 --> 00:11:06,836
要看模型的


228
00:11:06,836 --> 00:11:08,186
纯文本文本形式


229
00:11:08,606 --> 00:11:09,666
你可以使用 USDcat


230
00:11:17,356 --> 00:11:18,666
还有另一种通用情况


231
00:11:19,656 --> 00:11:25,476
这儿有个 obj 文件


232
00:11:25,696 --> 00:11:27,976
还有很多材料纹理


233
00:11:34,016 --> 00:11:35,776
把纹理分配给材料很简单


234
00:11:35,856 --> 00:11:37,896
就像分配常量一样


235
00:11:43,756 --> 00:11:47,446
USDZ 文件是一个未压缩的 zip 存档


236
00:11:47,936 --> 00:11:49,396
所以查看其内容的快捷方法是


237
00:11:49,396 --> 00:11:51,196
用 zip info


238
00:11:51,486 --> 00:11:55,916
这里我们可以看到一个 USDZ 存档 


239
00:11:55,976 --> 00:11:59,116
包含 USDZ 文件和以上所有的纹理


240
00:12:03,536 --> 00:12:05,176
这里你可以看到所有的材料纹理 


241
00:12:05,176 --> 00:12:06,586
应用到模型上


242
00:12:07,186 --> 00:12:10,866
所以 总的来说 用 USDZconvert 


243
00:12:10,866 --> 00:12:13,596
将已有素材转换为 USDZ


244
00:12:13,636 --> 00:12:14,776
会很简单


245
00:12:15,606 --> 00:12:17,826
还有一套其他的工具 


246
00:12:17,826 --> 00:12:19,466
它们会帮你检查 


247
00:12:19,466 --> 00:12:21,306
生成素材


248
00:12:22,406 --> 00:12:23,196
又轮到你了 Denis


249
00:12:24,516 --> 00:12:28,196
[掌声]


250
00:12:28,696 --> 00:12:29,976
谢谢你 Chloe


251
00:12:35,636 --> 00:12:39,056
刚才就是转换部分


252
00:12:39,506 --> 00:12:41,046
现在我们来看一下 


253
00:12:41,046 --> 00:12:42,976
如何从头开始创建 USDZ 文件


254
00:12:46,516 --> 00:12:48,616
当然可以用你最爱的创作工具


255
00:12:48,616 --> 00:12:50,646
创建你的素材


256
00:12:50,966 --> 00:12:53,416
它有可能会导出了一个格式   


257
00:12:53,416 --> 00:12:55,536
比如 FBX


258
00:12:55,536 --> 00:12:57,476
你可以接着用


259
00:12:57,476 --> 00:12:59,366
我们刚才看到的 USDZconvert


260
00:12:59,366 --> 00:13:00,983
将其转换为 USDZ 


261
00:13:04,046 --> 00:13:05,936
但是有越来越多的


262
00:13:05,996 --> 00:13:07,406
内容创作 App 


263
00:13:07,546 --> 00:13:09,506
支持直接导出 USD


264
00:13:10,756 --> 00:13:13,946
这使得结合内容创建步骤和 USD 流程


265
00:13:13,946 --> 00:13:15,806
变得更加容易


266
00:13:16,536 --> 00:13:19,536
转换步骤本来很复杂  


267
00:13:19,536 --> 00:13:20,706
因为有一些潜在的翻译过程


268
00:13:20,706 --> 00:13:22,476
但是现在实现起来


269
00:13:22,526 --> 00:13:24,506
变得简单多了


270
00:13:27,026 --> 00:13:29,356
这里有两个内容创作工具 


271
00:13:29,356 --> 00:13:32,626
支持 USD 导出


272
00:13:33,776 --> 00:13:35,116
这个是 Adobe 的 Substance Painter


273
00:13:35,116 --> 00:13:38,076
它是个很好的工具 


274
00:13:38,076 --> 00:13:39,916
可以为你的 3D 对象


275
00:13:39,916 --> 00:13:40,856
创作逼真的材料


276
00:13:41,426 --> 00:13:45,646
它支持 USD 和 USDZ 导出


277
00:13:46,186 --> 00:13:49,836
这个是 Autodesk Maya 


278
00:13:49,836 --> 00:13:52,436
最重要的 3D 模型和动画工具之一


279
00:13:52,986 --> 00:13:57,716
它支持 USD 和 USDZ 输出


280
00:13:57,956 --> 00:14:01,516
只需一个由 Pixar 编写并负责的插件


281
00:14:02,126 --> 00:14:05,826
正如我们所见


282
00:14:05,896 --> 00:14:08,496
很多这些 App


283
00:14:08,496 --> 00:14:11,556
甚至支持直接导出 USDZ


284
00:14:11,776 --> 00:14:13,816
进一步简化了 USDZ 创作步骤


285
00:14:14,406 --> 00:14:18,836
因为有 USD 的 Python 绑定  


286
00:14:18,836 --> 00:14:20,786
你也可以创建


287
00:14:20,786 --> 00:14:23,616
自定义 Python 流程


288
00:14:23,686 --> 00:14:25,956
为你的内容定做流程


289
00:14:27,366 --> 00:14:29,996
接下来 我们要让从 SceneKit 


290
00:14:29,996 --> 00:14:32,466
导出 USDZ 变得很简单


291
00:14:33,336 --> 00:14:35,176
你要做的只是 


292
00:14:35,176 --> 00:14:37,466
像以前一样创建或下载 SCNScene 


293
00:14:37,996 --> 00:14:39,216
当你准备好   


294
00:14:39,216 --> 00:14:41,976
导出 USDZ 时


295
00:14:41,976 --> 00:14:45,516
你只需一个 API 调用


296
00:14:45,516 --> 00:14:46,976
写入 并确保文件扩展是 USDZ


297
00:14:51,816 --> 00:14:54,496
实际上 我们也已经将 USDZ 导出


298
00:14:54,496 --> 00:14:56,946
结合到 Xcode 的 


299
00:14:56,946 --> 00:14:57,776
SceneKit Editor 中


300
00:14:58,556 --> 00:15:00,606
所以你可以通过命令直接导出 


301
00:15:00,866 --> 00:15:02,826
也可以通过一个


302
00:15:02,826 --> 00:15:03,846
用户界面来实现


303
00:15:04,626 --> 00:15:07,956
这就是工作流部分


304
00:15:09,486 --> 00:15:13,966
现在我们看一下 USD 的功能


305
00:15:14,666 --> 00:15:16,226
在介绍中 


306
00:15:16,226 --> 00:15:18,446
我们已经提到


307
00:15:18,446 --> 00:15:19,316
有一个很大的功能集


308
00:15:19,786 --> 00:15:21,766
这次讲演时间有限 


309
00:15:21,766 --> 00:15:22,976
甚至都不可能提到所有的功能


310
00:15:26,536 --> 00:15:28,606
但是这里有几个重点概念


311
00:15:28,876 --> 00:15:32,846
比较好理解


312
00:15:32,996 --> 00:15:34,806
所以先讲解这些


313
00:15:40,056 --> 00:15:41,306
我们会介绍四个概念


314
00:15:41,306 --> 00:15:43,636
文件结构 场景图


315
00:15:44,806 --> 00:15:48,976
网格数据 和材料


316
00:15:49,546 --> 00:15:53,506
USD 的一个主要区别特征是  


317
00:15:53,506 --> 00:15:54,726
它的纯文本格式


318
00:15:54,726 --> 00:15:57,676
是可读取 可理解的


319
00:15:59,006 --> 00:16:00,296
所以格式就没有那么神秘 


320
00:16:00,296 --> 00:16:02,566
更加透明


321
00:16:03,376 --> 00:16:05,236
发生错误时 你可以更快确定 


322
00:16:05,236 --> 00:16:07,466
哪儿错了 为什么错了


323
00:16:11,936 --> 00:16:13,676
我首先介绍一下文件结构


324
00:16:17,676 --> 00:16:22,556
它是 USDA 文件的一个片段


325
00:16:23,446 --> 00:16:24,996
首先你会注意到 


326
00:16:25,426 --> 00:16:28,376
它包含的这些嵌套容器


327
00:16:29,096 --> 00:16:30,616
在 USD 中 它们被称为 Prim


328
00:16:33,156 --> 00:16:35,586
这些 Prim 包含属性


329
00:16:35,956 --> 00:16:37,516
属性存储着真实数据


330
00:16:38,136 --> 00:16:42,126
这里有一套元数据


331
00:16:42,586 --> 00:16:45,906
关联到到文件级 


332
00:16:45,906 --> 00:16:48,746
Prim 级 或属性级


333
00:16:49,266 --> 00:16:51,526
因为是嵌套结构


334
00:16:52,156 --> 00:16:54,216
所以可以通过对象路径


335
00:16:54,646 --> 00:16:55,596
访问每个对象


336
00:16:56,416 --> 00:16:59,566
在这种情况下 


337
00:16:59,566 --> 00:17:01,606
“cube”这个 Prim 被嵌套在一个简单网格下 


338
00:17:01,646 --> 00:17:03,916
所以它的路径变成了 /simpleMesh/cube


339
00:17:06,396 --> 00:17:09,256
你也可以用点标记


340
00:17:09,685 --> 00:17:10,596
来为它附加属性


341
00:17:14,996 --> 00:17:16,376
我们已经看过了基本的文件结构


342
00:17:16,376 --> 00:17:17,915
接下来我们来看一下 


343
00:17:17,915 --> 00:17:20,146
如何使用它来存储场景数据


344
00:17:20,806 --> 00:17:25,175
场景图定义对象层级


345
00:17:26,195 --> 00:17:29,186
改变父类会影响它的子类


346
00:17:29,836 --> 00:17:31,876
在这个例子中 我们有一个立方体 


347
00:17:31,876 --> 00:17:35,096
立方体是球体的父对象


348
00:17:35,206 --> 00:17:38,146
如果你移动立方体 球体也会跟着移动


349
00:17:38,726 --> 00:17:43,866
如果你移动球体 立方体不动


350
00:17:44,476 --> 00:17:47,396
通过 USD 的嵌套 Prim 结构 


351
00:17:47,516 --> 00:17:48,996
场景图变得易于存储 


352
00:17:48,996 --> 00:17:51,886
你可以看到外层父 Prim 


353
00:17:51,936 --> 00:17:54,526
和两个子 Prim 


354
00:17:54,526 --> 00:17:56,166
立方体和球体


355
00:17:56,736 --> 00:18:00,496
你也可以看到 


356
00:18:00,496 --> 00:18:02,726
这里有其他的 Prim 


357
00:18:02,726 --> 00:18:04,706
比如 材料 或者


358
00:18:05,016 --> 00:18:05,976
并不属于场景图的动画


359
00:18:09,516 --> 00:18:11,026
这就是场景图部分


360
00:18:11,926 --> 00:18:16,496
现在我们来看一下网格数据


361
00:18:16,496 --> 00:18:19,216
网格数据大致分为两类


362
00:18:19,826 --> 00:18:21,206
第一类是网格属性 比如 


363
00:18:21,206 --> 00:18:23,756
位置 法线 和纹理坐标


364
00:18:25,366 --> 00:18:28,046
第二类是网格连接 比如


365
00:18:28,416 --> 00:18:30,836
每面的顶点数


366
00:18:31,186 --> 00:18:36,866
或者哪些顶点索引属于这面


367
00:18:37,076 --> 00:18:38,616
来看一个


368
00:18:38,616 --> 00:18:40,076
四面体的简单例子


369
00:18:40,736 --> 00:18:42,556
我们以一组点开始


370
00:18:42,756 --> 00:18:44,116
四面体的四个点


371
00:18:44,816 --> 00:18:48,936
每个面包含三个顶点 


372
00:18:48,936 --> 00:18:51,076
所以有四个三角


373
00:18:51,636 --> 00:18:54,666
每个面我们也存储了


374
00:18:54,666 --> 00:18:56,416
顶点索引


375
00:18:56,896 --> 00:19:01,236
接下来存储法线


376
00:19:01,326 --> 00:19:02,486
在这种情况下 我们选择


377
00:19:02,486 --> 00:19:03,756
存储每个面的法线


378
00:19:04,506 --> 00:19:07,186
所以是四条法线


379
00:19:08,066 --> 00:19:11,006
每个面的属性 用 USD 的语言来说 


380
00:19:11,006 --> 00:19:12,666
就是统一


381
00:19:12,666 --> 00:19:15,336
所以元数据设置为“uniform”


382
00:19:17,796 --> 00:19:19,876
存储文本坐标也是这样的


383
00:19:20,546 --> 00:19:21,856
它们被分为 


384
00:19:21,856 --> 00:19:25,286
索引 网格属性 


385
00:19:25,286 --> 00:19:26,716
索引是每面的 每个顶点的 


386
00:19:27,106 --> 00:19:30,326
用 USD 的语言来说是


387
00:19:30,326 --> 00:19:36,466
“faceVarying”


388
00:19:36,626 --> 00:19:38,146
最后我们要确保这个四面体


389
00:19:38,146 --> 00:19:40,306
是一个多边形


390
00:19:40,306 --> 00:19:42,776
而不是一个细分曲面


391
00:19:43,276 --> 00:19:46,496
我们一会会回到这一点上


392
00:19:46,726 --> 00:19:47,616
现在我们已经看过了场景图


393
00:19:47,616 --> 00:19:49,026
网格数据


394
00:19:49,026 --> 00:19:50,966
接下来看一下材料是如何被定义的


395
00:19:54,966 --> 00:19:57,346
USD 的材料定义很丰富


396
00:19:57,766 --> 00:20:00,886
用于输出电影画质的素材


397
00:20:01,586 --> 00:20:02,606
对于真实的实时渲染


398
00:20:02,606 --> 00:20:04,236
有一个更小的子集 


399
00:20:04,236 --> 00:20:06,376
叫作 UsdPreviewSurface


400
00:20:07,156 --> 00:20:08,626
这是个基于实物材料的描述


401
00:20:08,626 --> 00:20:10,706
支持两个数据流


402
00:20:10,706 --> 00:20:12,646
金属粗糙度


403
00:20:13,176 --> 00:20:14,246
和镜面粗糙度


404
00:20:14,246 --> 00:20:15,736
这里我们会集中介绍


405
00:20:15,736 --> 00:20:16,696
金属粗糙度


406
00:20:17,306 --> 00:20:20,406
举个例子


407
00:20:20,406 --> 00:20:21,546
我们刚才在 Chloe 的演示中


408
00:20:21,546 --> 00:20:24,906
看到的留声机


409
00:20:25,006 --> 00:20:26,576
我们先指定常量白色


410
00:20:27,106 --> 00:20:32,866
接着 我们设置法线 


411
00:20:32,866 --> 00:20:36,626
最后遮蔽贴图 展现细节


412
00:20:40,916 --> 00:20:43,386
接下来 


413
00:20:43,956 --> 00:20:45,606
我们提高它的金属度


414
00:20:45,816 --> 00:20:46,446
它就会变得亮闪闪


415
00:20:47,776 --> 00:20:51,576
我们再加一个粗糙度贴图 


416
00:20:51,576 --> 00:20:57,476
让对象的一些部分变暗


417
00:20:57,626 --> 00:21:00,966
最后我们设置漫射色


418
00:21:00,966 --> 00:21:04,536
和金属纹理


419
00:21:04,866 --> 00:21:07,316
通过这五种纹理 


420
00:21:07,316 --> 00:21:09,006
这个网格最终变得


421
00:21:09,006 --> 00:21:10,496
美观 逼真


422
00:21:11,146 --> 00:21:13,886
我们来看一下 在 USD 中 


423
00:21:14,336 --> 00:21:16,596
它是如何被描述的


424
00:21:16,596 --> 00:21:18,736
USD 用的是着色节点图  


425
00:21:19,076 --> 00:21:21,146
有分离的着色节点


426
00:21:21,386 --> 00:21:26,016
彼此相关


427
00:21:26,216 --> 00:21:28,536
UsdPreviewSurface 有一个非常简单的


428
00:21:28,586 --> 00:21:30,256
着色节点图结构


429
00:21:30,256 --> 00:21:32,936
只有 4 种节点类型


430
00:21:34,246 --> 00:21:35,626
主着色节点


431
00:21:35,626 --> 00:21:37,416
定义所有的 PBR 属性


432
00:21:37,416 --> 00:21:38,606
刚才我们已经看到了其中五个


433
00:21:39,936 --> 00:21:41,526
纹理采样器告诉你


434
00:21:41,526 --> 00:21:44,996
要用哪个纹理  


435
00:21:44,996 --> 00:21:47,256
网格属性读取器


436
00:21:47,516 --> 00:21:51,036
负责纹理坐标之类的属性


437
00:21:51,766 --> 00:21:53,686
还有 UV 转换节点


438
00:21:53,686 --> 00:21:57,956
让你可以改变或者旋转纹理坐标


439
00:21:58,456 --> 00:22:01,766
我们来看一个最简单的例子


440
00:22:01,766 --> 00:22:03,866
几个常量的例子


441
00:22:04,226 --> 00:22:05,916
网格属性的常量


442
00:22:09,156 --> 00:22:12,736
这里 你可以看到  


443
00:22:12,736 --> 00:22:15,096
主着色节点的表面输出


444
00:22:15,096 --> 00:22:17,146
和材料表面输出是相连的


445
00:22:18,376 --> 00:22:20,306
在 USD 中看起来是这样的


446
00:22:20,306 --> 00:22:22,846
我们有外嵌套材料 Prim


447
00:22:23,396 --> 00:22:26,886
里面包含主着色节点 Prim 


448
00:22:26,886 --> 00:22:31,206
着色节点输出和


449
00:22:31,206 --> 00:22:33,416
材料的输出是相连的


450
00:22:33,416 --> 00:22:37,296
用的是我们已经看过的对象路径


451
00:22:38,776 --> 00:22:40,256
接下来 我们看一个


452
00:22:40,256 --> 00:22:41,686
稍复杂一点的纹理的例子   


453
00:22:42,096 --> 00:22:44,766
这个纹理被指定给


454
00:22:44,766 --> 00:22:46,006
diffuseColor 通道


455
00:22:46,516 --> 00:22:50,426
我们需要一个网格属性读取器 


456
00:22:50,466 --> 00:22:51,226
来处理纹理坐标


457
00:22:51,226 --> 00:22:52,896
也就是前面这个红色节点


458
00:22:52,896 --> 00:22:57,276
我们想要应用的纹理样本


459
00:22:57,276 --> 00:23:00,166
这是个橘色的  


460
00:23:01,046 --> 00:23:03,636
包含 diffuseColor 属性的


461
00:23:03,676 --> 00:23:05,106
主 PBR 着色节点


462
00:23:09,176 --> 00:23:11,126
在 USD 中看起来是这样的


463
00:23:11,126 --> 00:23:13,936
我们再次有了外层的材料 Prim 


464
00:23:13,936 --> 00:23:18,496
和三个着色节点


465
00:23:19,016 --> 00:23:22,766
输出和下一个着色节点的


466
00:23:22,766 --> 00:23:24,296
一些输入相连


467
00:23:24,856 --> 00:23:31,406
好 这就是 USD 的重点部分


468
00:23:31,456 --> 00:23:33,416
我们刚才介绍的这些概念


469
00:23:33,416 --> 00:23:36,476
都在“samples”文件夹里


470
00:23:36,476 --> 00:23:38,376
我们用很少的样本脚本  这样你就可以


471
00:23:38,376 --> 00:23:40,416
创建了场景图 网格数据 


472
00:23:40,416 --> 00:23:43,926
材料 和网格组


473
00:23:43,956 --> 00:23:45,556
所以你可以分配


474
00:23:45,556 --> 00:23:46,726
多个材料到单一网格


475
00:23:46,726 --> 00:23:49,336
甚至是动画


476
00:23:49,376 --> 00:23:51,176
用于变换动画


477
00:23:51,176 --> 00:23:52,866
蒙皮和骨骼动画的动画


478
00:23:57,826 --> 00:23:59,376
我们已经介绍了 USD 的基本结构


479
00:23:59,376 --> 00:24:01,046
我们现在来看一下


480
00:24:01,046 --> 00:24:05,116
它区别于其他格式的主要优点


481
00:24:06,976 --> 00:24:08,726
可扩展性 复杂场景 


482
00:24:09,246 --> 00:24:11,426
静物构图 多人合作


483
00:24:17,616 --> 00:24:19,796
对于可扩展性 


484
00:24:19,796 --> 00:24:21,676
我们会介绍细分曲面


485
00:24:23,216 --> 00:24:25,046
合作方面


486
00:24:25,046 --> 00:24:26,546
我们会介绍创作引擎


487
00:24:27,126 --> 00:24:30,136
我们从细分曲面开始


488
00:24:32,146 --> 00:24:33,676
细分曲面在表现曲面这方面


489
00:24:33,676 --> 00:24:36,466
并不高效


490
00:24:37,506 --> 00:24:40,026
相反 


491
00:24:40,026 --> 00:24:41,416
多边形表面描述


492
00:24:41,416 --> 00:24:44,806
才趋近真正的曲面


493
00:24:44,996 --> 00:24:47,396
这个趋近基于一些假设  


494
00:24:47,396 --> 00:24:49,606
比如 什么算是比较趋近


495
00:24:49,606 --> 00:24:51,566
你想要成品和实物


496
00:24:51,566 --> 00:24:55,186
有多么相似


497
00:24:55,856 --> 00:24:58,336
与此相反


498
00:24:58,336 --> 00:25:00,296
细分曲面描述真实的表面


499
00:25:00,756 --> 00:25:04,306
所以你可以做一个动态细分  


500
00:25:04,306 --> 00:25:06,636
比如根据到相机的距离 


501
00:25:06,966 --> 00:25:08,856
用小的多边形


502
00:25:09,516 --> 00:25:12,836
找到一个比较趋近真实物体的形状


503
00:25:14,996 --> 00:25:16,666
细分曲面


504
00:25:16,666 --> 00:25:18,466
同样适合动画内容


505
00:25:19,066 --> 00:25:22,486
我们在过去的年里 


506
00:25:22,486 --> 00:25:24,596
一直使用细分曲面


507
00:25:24,596 --> 00:25:28,076
比如 用它做 


508
00:25:28,076 --> 00:25:30,316
动话表情或拟我表情


509
00:25:30,956 --> 00:25:36,276
在左手边你可以看到 


510
00:25:36,276 --> 00:25:38,016
用细分控制网格做出的


511
00:25:38,016 --> 00:25:40,106
多边形表面是什么样子的


512
00:25:40,836 --> 00:25:41,956
可以看出来 线条很美 


513
00:25:41,956 --> 00:25:44,756
从内存占用角度来说


514
00:25:44,756 --> 00:25:46,266
这个表现堪称出色


515
00:25:47,356 --> 00:25:49,356
右手边是


516
00:25:49,416 --> 00:25:51,026
最后的细分表面


517
00:25:51,026 --> 00:25:54,316
可以看到很漂亮的细节


518
00:25:56,036 --> 00:25:57,486
细分曲面的


519
00:25:57,486 --> 00:26:01,586
工业标准是 OpenSubdiv 


520
00:26:01,586 --> 00:26:02,506
也是 Pixar 开发的


521
00:26:03,396 --> 00:26:04,816
为提供最适合我们平台的


522
00:26:04,816 --> 00:26:07,106
金属着色器 


523
00:26:07,106 --> 00:26:11,646
我们和一直和 Pixar 密切合作


524
00:26:11,996 --> 00:26:17,116
所以 GPU 发展得非常快


525
00:26:17,216 --> 00:26:19,846
OpenSubdiv 是 Scenekit 里


526
00:26:19,846 --> 00:26:21,866
细分曲面的基础


527
00:26:22,136 --> 00:26:29,086
当然  USD 能很好地支持细分曲面


528
00:26:29,456 --> 00:26:31,126
也适用于 OpenSubdiv


529
00:26:32,156 --> 00:26:35,686
实际上  USD 既可以描述多边形网格数据


530
00:26:35,686 --> 00:26:38,066
也可以描述细分曲面数据


531
00:26:39,096 --> 00:26:41,786
它还可以特定于细分


532
00:26:41,786 --> 00:26:43,646
支持细分特定属性


533
00:26:43,936 --> 00:26:46,686
比如折痕或角


534
00:26:50,146 --> 00:26:51,726
细分曲面这部分就结束了


535
00:26:51,726 --> 00:26:53,726
它可以出色有效地


536
00:26:53,766 --> 00:26:57,176
存储高质量表面


537
00:26:57,416 --> 00:27:01,726
现在我们来看一下创作引擎


538
00:27:06,096 --> 00:27:07,926
创作引擎一个


539
00:27:08,096 --> 00:27:10,206
非常有用的创作工具


540
00:27:10,206 --> 00:27:13,006
可以让美术师们有效合作


541
00:27:13,786 --> 00:27:15,736
我们来看一个


542
00:27:15,736 --> 00:27:18,046
引用的例子


543
00:27:18,536 --> 00:27:21,826
我们再次拿出这个场景图


544
00:27:22,306 --> 00:27:26,526
父节点下有两个子对象


545
00:27:27,246 --> 00:27:28,856
只要那两个对象是不同的 


546
00:27:28,856 --> 00:27:30,676
这就是一个


547
00:27:30,756 --> 00:27:31,866
有效的展示


548
00:27:32,406 --> 00:27:36,836
但是如果你的场景图中 


549
00:27:36,836 --> 00:27:39,416
有一个对象的多个副本


550
00:27:39,416 --> 00:27:40,166
怎么办


551
00:27:41,066 --> 00:27:43,516
那么这个嵌套场景图结构 


552
00:27:43,516 --> 00:27:45,236
会变得没有效率


553
00:27:45,236 --> 00:27:47,776
因为它会存储重复数据


554
00:27:52,916 --> 00:27:56,066
大多数文件格式  


555
00:27:56,126 --> 00:27:58,446
都会分离重复数据


556
00:27:58,446 --> 00:28:01,746
而存储引用


557
00:28:01,746 --> 00:28:02,696
并且也使用支持集


558
00:28:03,686 --> 00:28:04,986
但是不止如此


559
00:28:06,196 --> 00:28:10,166
它还在这个


560
00:28:10,516 --> 00:28:12,906
嵌套场景图 Prim 结构中


561
00:28:12,906 --> 00:28:15,586
创建虚拟对象


562
00:28:15,616 --> 00:28:19,676
每个虚拟对象


563
00:28:19,676 --> 00:28:23,276
都有自己独立的对象路径


564
00:28:23,276 --> 00:28:25,916
你就可以进入并重写它的内容


565
00:28:25,916 --> 00:28:29,226
它的一些属性


566
00:28:29,516 --> 00:28:31,576
比如 在这种情况下  


567
00:28:32,356 --> 00:28:34,706
我重写第二个球体的


568
00:28:35,326 --> 00:28:38,786
材料颜色为黄色


569
00:28:38,786 --> 00:28:40,616
又不会改变第一个球体的材料


570
00:28:44,496 --> 00:28:46,626
你还可以把整个子树 


571
00:28:46,626 --> 00:28:49,256
从你的场景图中去除


572
00:28:49,826 --> 00:28:51,886
USD 将所有这些编辑 


573
00:28:51,886 --> 00:28:56,246
存储为对原始数据的有效重写 


574
00:28:56,886 --> 00:29:00,126
现在我们看一下 


575
00:29:00,126 --> 00:29:01,476
这对美术师工作流有什么影响


576
00:29:01,956 --> 00:29:04,976
这是 macOS Catalina 里的 访达


577
00:29:06,156 --> 00:29:09,676
你可以看到这里


578
00:29:09,676 --> 00:29:13,696
macOS 可以快速查看渲染场景的 USD 文件


579
00:29:13,986 --> 00:29:16,816
现在假设我是一个布局美术师


580
00:29:16,816 --> 00:29:19,866
将所有的这些对象


581
00:29:19,866 --> 00:29:22,446
布局到场景中


582
00:29:22,916 --> 00:29:26,756
同时还有一个美术师


583
00:29:26,756 --> 00:29:28,346
负责渲染


584
00:29:28,346 --> 00:29:30,136
其中一些对象


585
00:29:30,176 --> 00:29:32,036
比如 这个椅子


586
00:29:32,566 --> 00:29:35,206
这个美术师用这个椅子


587
00:29:35,206 --> 00:29:39,096
替换了之前的那个


588
00:29:40,506 --> 00:29:43,596
现在 如果你回到布局文件  


589
00:29:43,596 --> 00:29:46,776
你可以看到


590
00:29:46,776 --> 00:29:49,206
这些对象已经自动被替换


591
00:29:49,206 --> 00:29:51,026
文件没有改变 


592
00:29:51,026 --> 00:29:51,816
只是带入了引用 


593
00:29:52,256 --> 00:29:55,626
实际上 我可以自己编辑


594
00:29:56,186 --> 00:30:00,626
比如 在不影响 


595
00:30:00,906 --> 00:30:02,456
其他美术师的文件的同时


596
00:30:02,456 --> 00:30:03,626
改变颜色


597
00:30:04,226 --> 00:30:07,656
这就分离了


598
00:30:07,656 --> 00:30:08,846
我们的工作流


599
00:30:12,636 --> 00:30:15,046
这就是对 USD 支持的  


600
00:30:15,366 --> 00:30:17,916
所有新美术师工作流的


601
00:30:17,916 --> 00:30:19,616
简单讲解


602
00:30:23,616 --> 00:30:26,336
在“samples”文件夹里  


603
00:30:26,336 --> 00:30:28,346
我们还有两个例子


604
00:30:28,346 --> 00:30:31,096
比这些 USD 功能更高级


605
00:30:32,396 --> 00:30:34,036
折痕的细分曲面


606
00:30:34,096 --> 00:30:37,446
和重写引用


607
00:30:46,046 --> 00:30:48,166
总结一下 我们已经


608
00:30:48,166 --> 00:30:49,536
大致介绍了场景描述


609
00:30:49,746 --> 00:30:51,496
它是一个文件类型 


610
00:30:51,496 --> 00:30:54,716
一个有用的库 用来编辑


611
00:30:54,716 --> 00:30:56,966
所有展现 3D 内容的方式


612
00:30:58,516 --> 00:31:00,256
我们介绍了用来创建素材


613
00:31:00,256 --> 00:31:03,236
和将其转换为 USDZ 的工作流


614
00:31:03,236 --> 00:31:06,006
我们介绍了一个新的工具 usdzconvert 


615
00:31:06,006 --> 00:31:08,246
它可以将 .obj .gltf .fbx 和其他文件格式


616
00:31:08,246 --> 00:31:11,546
转换为 USDZ


617
00:31:11,546 --> 00:31:14,936
你可以从我们的网站  


618
00:31:14,936 --> 00:31:16,966
下载这些 Python USDX 工具


619
00:31:16,966 --> 00:31:19,156
包括 usdzconvert


620
00:31:19,156 --> 00:31:21,136
一个预编译的 USD 库


621
00:31:21,266 --> 00:31:21,976
和一些样本脚本


622
00:31:27,846 --> 00:31:29,626
如果你想要了解更多信息 


623
00:31:29,626 --> 00:31:31,486
请查看讲演页面 


624
00:31:32,356 --> 00:31:34,106
明天下午 3 点我们还会有一个


625
00:31:34,106 --> 00:31:37,496
USD 和 USDZ 的实验室 


626
00:31:37,496 --> 00:31:39,156
你还可以看一下


627
00:31:39,156 --> 00:31:43,976
周五上午 9 点的《Advances in AR Quick Look》


628
00:31:44,176 --> 00:31:50,500
谢谢 [掌声]

