1
00:00:01,516 --> 00:00:05,826
[音乐]


2
00:00:06,326 --> 00:00:08,306
>> 嗨 我是 Tim Horton


3
00:00:08,306 --> 00:00:09,646
来自 Safari 和 Webkit 团队的 


4
00:00:10,426 --> 00:00:11,706
我将要为你展示如何


5
00:00:11,706 --> 00:00:13,516
在你的 App 中显示 Rich Link


6
00:00:14,836 --> 00:00:17,306
在 iOS 10 和 macOS Sierra 中


7
00:00:17,306 --> 00:00:18,546
我们介绍了信息中的 Rich Link 


8
00:00:18,546 --> 00:00:20,376
它是一个让 URL


9
00:00:20,376 --> 00:00:23,396
更美观更实用的途径


10
00:00:23,396 --> 00:00:24,506
为了最大化的


11
00:00:24,506 --> 00:00:25,356
利用这个优势 我们建立了


12
00:00:25,356 --> 00:00:28,326
针对某几种链接的规范


13
00:00:28,326 --> 00:00:30,176
这些包括了类似


14
00:00:30,176 --> 00:00:31,446
內联视频和音频播放


15
00:00:31,446 --> 00:00:33,756
以及一个对 Tweets 的特别演示


16
00:00:34,086 --> 00:00:35,296
它包括含有多张图片


17
00:00:35,296 --> 00:00:37,286
以及其他


18
00:00:37,396 --> 00:00:38,556
例如 Apple Maps 的链接


19
00:00:41,566 --> 00:00:45,276
今年 iOS 13 和 macOS 10.15


20
00:00:45,276 --> 00:00:47,166
带来了新的 API 它可以让你


21
00:00:47,166 --> 00:00:48,686
在你自己的


22
00:00:48,686 --> 00:00:50,516
App 中展示 Rich Link 


23
00:00:48,686 --> 00:00:50,516
这样你就可以


24
00:00:50,516 --> 00:00:52,356
用最少的精力 享受最多的好处


25
00:00:53,276 --> 00:00:54,686
在这个视频中我们将


26
00:00:54,686 --> 00:00:56,586
随着创建这个


27
00:00:56,586 --> 00:00:58,356
相当简单的食谱标记 App 的过程中


28
00:00:58,356 --> 00:01:00,566
我们逐步的用到


29
00:01:00,566 --> 00:01:03,596
新的 Link Presentation 框架的功能


30
00:01:03,596 --> 00:01:05,525
来从一个平淡无奇的 URL 列表到


31
00:01:05,525 --> 00:01:07,686
像这样一个丰富的链接网格


32
00:01:07,686 --> 00:01:08,376
而且这不需要花很多时间


33
00:01:10,396 --> 00:01:11,716
要做到这个


34
00:01:11,716 --> 00:01:13,326
我将涵盖 3 个主题


35
00:01:13,326 --> 00:01:15,296
首先 如何呈现元数据


36
00:01:15,296 --> 00:01:16,296
例如一个 URL


37
00:01:16,406 --> 00:01:19,096
第二 如何轻松呈现


38
00:01:19,096 --> 00:01:20,586
这个元数据给用户


39
00:01:21,286 --> 00:01:23,506
然后第三 如何使用取回的


40
00:01:23,506 --> 00:01:24,966
元数据来加速


41
00:01:24,966 --> 00:01:26,396
新的分享表单展示


42
00:01:26,396 --> 00:01:28,806
在 iOS 13 中


43
00:01:30,426 --> 00:01:31,986
那么让我们从检索


44
00:01:31,986 --> 00:01:32,416
元数据开始吧


45
00:01:34,396 --> 00:01:36,276
在菜谱 App 中让我们说


46
00:01:36,276 --> 00:01:37,546
你已经有了一些


47
00:01:37,546 --> 00:01:39,496
给用户获取 URL


48
00:01:39,496 --> 00:01:40,226
到 App 里的机制


49
00:01:41,226 --> 00:01:42,496
你可以把它们呈现


50
00:01:42,496 --> 00:01:44,556
在一个表格中


51
00:01:44,556 --> 00:01:46,046
但 URL 并不是非常用户友好的


52
00:01:46,276 --> 00:01:47,666
在这种情况下


53
00:01:49,996 --> 00:01:51,326
你的确可以改为让用户


54
00:01:51,326 --> 00:01:52,936
给每个链接起一个标题


55
00:01:52,986 --> 00:01:54,266
但是我们可以让它变得更加容易


56
00:01:55,686 --> 00:01:57,686
使用新的 Link Presentation 框架


57
00:01:57,686 --> 00:01:59,936
它很容易使用


58
00:01:59,966 --> 00:02:02,286
LPMetadataProvider类


59
00:02:04,926 --> 00:02:07,646
你只需提供 URL 然后它


60
00:02:07,646 --> 00:02:10,026
反馈给你 LPLinkMetadata 文件


61
00:02:10,026 --> 00:02:11,836
包含一个具有代表性的


62
00:02:11,836 --> 00:02:14,066
标题并且在任何媒体都可以使用


63
00:02:14,066 --> 00:02:17,256
让我们看看这是什么样子的


64
00:02:17,606 --> 00:02:19,376
首先你创建一个


65
00:02:19,376 --> 00:02:22,266
LPMetadataProvider 然后调用


66
00:02:22,266 --> 00:02:23,956
startFetchingMetadata 加上


67
00:02:23,956 --> 00:02:26,786
你感兴趣的 URL


68
00:02:26,786 --> 00:02:27,936
当调用完成处理程序时


69
00:02:27,936 --> 00:02:29,766
要确保没有错误


70
00:02:30,146 --> 00:02:32,056
如果服务器没有响应或


71
00:02:32,056 --> 00:02:34,296
太慢或你的用户没有


72
00:02:34,296 --> 00:02:35,436
网络连接


73
00:02:35,756 --> 00:02:37,456
提取元数据可能会失败 


74
00:02:37,456 --> 00:02:40,396
最后 你可以使用元数据


75
00:02:40,396 --> 00:02:41,346
来干你想做的任何事


76
00:02:42,066 --> 00:02:43,306
我们将回到这一个时刻


77
00:02:44,916 --> 00:02:46,456
在我们继续之前有一些


78
00:02:46,456 --> 00:02:48,136
都要记住的事情


79
00:02:48,136 --> 00:02:49,966
在使用 metadataProvider 和


80
00:02:49,966 --> 00:02:51,226
LinkMetadata 过程中


81
00:02:51,716 --> 00:02:53,436
首先 得到的元数据


82
00:02:53,436 --> 00:02:54,906
对象可以包括任何


83
00:02:54,906 --> 00:02:58,166
标题 图标 图像 视频或都不包含


84
00:02:58,166 --> 00:03:00,086
如果网站没有指定任何内容


85
00:03:00,846 --> 00:03:03,526
它也可以使用安全编码进行序列化 


86
00:03:04,126 --> 00:03:05,356
这很重要 因为


87
00:03:05,356 --> 00:03:06,946
LPMetadataProvider 让


88
00:03:06,946 --> 00:03:08,766
互联网做相关的工作


89
00:03:08,766 --> 00:03:10,606
而你不想做相关工作


90
00:03:10,606 --> 00:03:11,916
也不想让你的用户为这些数据


91
00:03:11,916 --> 00:03:14,076
和功能付费


92
00:03:14,076 --> 00:03:15,246
每当你展示相同的链接时


93
00:03:15,706 --> 00:03:16,966
你应该缓存检索到的


94
00:03:16,966 --> 00:03:19,306
尽量多的本地元数据


95
00:03:20,586 --> 00:03:23,056
此外 你还可以获取


96
00:03:23,056 --> 00:03:25,486
本地 URL 的元数据


97
00:03:25,486 --> 00:03:26,996
新的快速查看缩略 API


98
00:03:26,996 --> 00:03:29,316
将用于检索一个


99
00:03:29,316 --> 00:03:31,716
有代表性的缩略图 尽它最大可能


100
00:03:33,806 --> 00:03:35,296
现在让我们谈谈如何将


101
00:03:35,296 --> 00:03:37,136
我们检索元数据投入实际使用中


102
00:03:37,136 --> 00:03:38,546
用我们的 App 来展示一下


103
00:03:39,946 --> 00:03:41,696
再一次说 这非常简单


104
00:03:41,896 --> 00:03:44,706
你可以用早些时候的一个对象


105
00:03:43,176 --> 00:03:45,726
并用它建立一个 LPLinkView 


106
00:03:48,416 --> 00:03:49,256
就这么简单


107
00:03:51,816 --> 00:03:53,506
让我们回到这个食谱 App


108
00:03:53,506 --> 00:03:55,366
并将 LPLinkViews 放在我们的


109
00:03:55,366 --> 00:03:56,366
表格视图单元格里面


110
00:03:57,846 --> 00:03:58,486
现在好多了


111
00:03:59,056 --> 00:04:00,226
现在你有一个非常熟悉的


112
00:04:00,226 --> 00:04:01,586
呈现方式让每个


113
00:04:01,586 --> 00:04:04,836
食谱在第一眼就很容易辨认


114
00:04:04,836 --> 00:04:06,476
LPLinkView 本身具有固有的大小


115
00:04:06,476 --> 00:04:10,726
但它也有会调节以此来符合理想的大小


116
00:04:10,726 --> 00:04:12,486
从而给出一定的限制


117
00:04:12,486 --> 00:04:14,586
我们会尝试呈现


118
00:04:14,586 --> 00:04:17,486
一些在任何尺寸的布局都是合理的东西


119
00:04:18,726 --> 00:04:20,065
我要谈的最后一件事


120
00:04:20,065 --> 00:04:21,416
是关于如何利用


121
00:04:21,416 --> 00:04:23,366
LinkMetadata 来加速


122
00:04:23,366 --> 00:04:26,966
在 iOS 13 中新的分享表单


123
00:04:28,496 --> 00:04:29,946
对于有共用 URL 的现有 App


124
00:04:29,946 --> 00:04:31,426
分享表单将会


125
00:04:31,426 --> 00:04:34,196
自动在卡片上方呈现链接的预览


126
00:04:35,026 --> 00:04:36,706
但是 这需要连接


127
00:04:36,706 --> 00:04:37,946
到服务器以进行检索元数据


128
00:04:37,946 --> 00:04:40,546
每次分享表单被展示的时候都是如此


129
00:04:41,046 --> 00:04:44,406
所以标题和图标是异步显示的


130
00:04:44,446 --> 00:04:45,596
让我们再看一遍


131
00:04:45,906 --> 00:04:48,256
注意观察分享表单的标题


132
00:04:48,736 --> 00:04:52,606
如果你已经有了一个


133
00:04:52,606 --> 00:04:54,846
URL 的 LPLinkMetadata 的对象


134
00:04:55,476 --> 00:04:56,596
你应该把它给


135
00:04:56,596 --> 00:04:58,266
分享表单然后预览就会


136
00:04:58,266 --> 00:05:00,506
无需从网络加载即可立即显示


137
00:05:01,196 --> 00:05:02,266
你可以使用新的


138
00:05:02,346 --> 00:05:05,826
activityViewControllerLinkMetadata 方法


139
00:05:05,826 --> 00:05:09,276
在对 UIActivityItemSource 的操作时


140
00:05:09,276 --> 00:05:10,816
只需返回元数据对象


141
00:05:10,816 --> 00:05:13,386
让我们来看看它们的区别


142
00:05:13,386 --> 00:05:14,816
在我们的食谱 App 中 如果我们提供的


143
00:05:14,816 --> 00:05:16,686
数据是我们已经在表格视图中使用过的


144
00:05:18,406 --> 00:05:20,056
好了很多


145
00:05:20,206 --> 00:05:21,706
同样值得注意的是


146
00:05:21,706 --> 00:05:22,966
如果用户选择共享


147
00:05:22,966 --> 00:05:25,046
到消息中


148
00:05:25,046 --> 00:05:26,196
同样的元数据会被直接传送


149
00:05:26,386 --> 00:05:27,826
并且整个过程流畅无缝


150
00:05:27,826 --> 00:05:29,966
没有任何不必要多余下载的体验 


151
00:05:31,086 --> 00:05:31,846
最后一件事


152
00:05:32,446 --> 00:05:33,976
如果你的 App 已经有了一个


153
00:05:33,976 --> 00:05:35,776
食谱数据库 且带有标题和图片


154
00:05:35,776 --> 00:05:38,226
并没有被链接的演示所抓取


155
00:05:38,846 --> 00:05:40,356
你不必重新抓取


156
00:05:40,356 --> 00:05:42,056
来自互联网的元数据


157
00:05:42,056 --> 00:05:43,216
以此来加速


158
00:05:43,216 --> 00:05:44,986
分享表单或展示一个 Rich Link


159
00:05:45,646 --> 00:05:47,216
相反 你可以在


160
00:05:47,216 --> 00:05:48,696
LPLinkMetadata 的地方


161
00:05:48,696 --> 00:05:51,406
填入你自己之前存在的数据来源


162
00:05:52,196 --> 00:05:53,436
你只需创建一个


163
00:05:53,436 --> 00:05:55,706
LPLinkMetadata 对象


164
00:05:55,706 --> 00:05:57,496
并至少填入原始的 URL 和 


165
00:05:57,496 --> 00:05:59,396
URL 字段加上任何


166
00:05:59,396 --> 00:06:01,366
你有的其他信息


167
00:06:03,066 --> 00:06:05,346
所以今天我们的三个关键要点是


168
00:06:05,956 --> 00:06:07,946
你可以使用 LPMetadataProvider


169
00:06:08,116 --> 00:06:10,286
来获取 URL 的丰富元数据


170
00:06:10,596 --> 00:06:12,366
为了提供更多的


171
00:06:12,366 --> 00:06:13,796
关于 URL 的内容


172
00:06:14,576 --> 00:06:16,026
你应该使用 LPLinkView


173
00:06:16,026 --> 00:06:17,716
来在你的 App 中显示链接


174
00:06:17,716 --> 00:06:19,116
以一种集美观与


175
00:06:19,116 --> 00:06:21,156
系统一致性于一体的方法


176
00:06:21,156 --> 00:06:22,366
并且你应该预先获取或使用


177
00:06:22,366 --> 00:06:24,216
已有的 LPLinkMetadata 来


178
00:06:24,216 --> 00:06:25,506
加速分享表单


179
00:06:25,506 --> 00:06:26,486
在你的 App 中的预览


180
00:06:27,546 --> 00:06:29,106
更多相关信息 请访问


181
00:06:29,146 --> 00:06:30,806
developer.apple.com 


182
00:06:32,076 --> 00:06:33,756
感谢你的参加

