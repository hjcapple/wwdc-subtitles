1
00:00:00,506 --> 00:00:04,500
[音乐]


2
00:00:07,716 --> 00:00:09,136
>> 大家好 欢迎


3
00:00:09,136 --> 00:00:11,076
收看我们的会议


4
00:00:11,076 --> 00:00:12,566
关于对音频单元用户预设的支持


5
00:00:13,096 --> 00:00:14,876
我叫 Bela Balazs


6
00:00:14,876 --> 00:00:16,236
我是 Core Audio


7
00:00:16,236 --> 00:00:17,096
软件团队的工程师


8
00:00:17,546 --> 00:00:18,726
今天我们将谈一谈


9
00:00:18,726 --> 00:00:19,886
一个新的 API


10
00:00:19,996 --> 00:00:21,386
用于处理


11
00:00:21,386 --> 00:00:22,376
音频单元的预设


12
00:00:24,096 --> 00:00:25,656
首先 我们先讨论一下


13
00:00:25,906 --> 00:00:27,586
什么是预设


14
00:00:27,586 --> 00:00:28,196
以及为什么它们很重要


15
00:00:29,276 --> 00:00:31,186
在一个音频软件情景中


16
00:00:31,186 --> 00:00:32,586
预设就是在给定时间点


17
00:00:32,586 --> 00:00:33,906
关于音频单元的


18
00:00:33,906 --> 00:00:35,616
参数状态的快照


19
00:00:36,466 --> 00:00:38,066
这个快照可以被保存


20
00:00:38,066 --> 00:00:38,976
并在之后恢复


21
00:00:41,216 --> 00:00:42,506
我们已经支持了


22
00:00:42,506 --> 00:00:43,096
工厂预设


23
00:00:43,786 --> 00:00:45,696
这是在 AUAudioUnit 类的一个属性


24
00:00:45,696 --> 00:00:48,136
它也被定义为


25
00:00:48,136 --> 00:00:50,436
AUAudioUnitPreset 的数组


26
00:00:50,926 --> 00:00:54,546
这些工厂预设


27
00:00:54,546 --> 00:00:55,936
由音频单元制造商


28
00:00:55,936 --> 00:00:57,096
加入至音频单元


29
00:00:57,686 --> 00:00:59,186
一个音频单元开发者


30
00:00:59,186 --> 00:01:00,236
可能会在产品中


31
00:01:00,236 --> 00:01:02,316
包含一定数量的预设


32
00:01:02,316 --> 00:01:03,936
以此作为起点


33
00:01:03,936 --> 00:01:05,586
或展示音频单元的性能


34
00:01:07,856 --> 00:01:09,266
现在我们增加了对


35
00:01:09,266 --> 00:01:10,166
用户预设的支持


36
00:01:10,786 --> 00:01:12,586
用户预设可以通过使用这个


37
00:01:12,586 --> 00:01:14,296
新的 userPresets 属性访问


38
00:01:15,016 --> 00:01:16,226
返回值为


39
00:01:16,226 --> 00:01:17,626
AUAudioUnitPreset 数组


40
00:01:19,966 --> 00:01:21,236
这些预设


41
00:01:21,236 --> 00:01:22,846
由用户创建


42
00:01:22,846 --> 00:01:23,906
之后可以修改


43
00:01:24,466 --> 00:01:26,086
音频单元会将预设提供给


44
00:01:26,116 --> 00:01:28,056
所有托管该音频单元的 App


45
00:01:28,446 --> 00:01:31,836
我们有一个新的属性


46
00:01:31,836 --> 00:01:33,156
名为 supportUsePresets


47
00:01:33,156 --> 00:01:35,326
音频单元将其设为真


48
00:01:35,326 --> 00:01:36,376
表示支持用户预设


49
00:01:36,766 --> 00:01:39,156
托管音频单元的 App


50
00:01:39,156 --> 00:01:40,616
在使用新的功能前


51
00:01:40,616 --> 00:01:41,596
需要先检查该属性


52
00:01:41,756 --> 00:01:44,456
这就是加入使用新功能的方法


53
00:01:46,786 --> 00:01:48,426
我们有保存和


54
00:01:48,426 --> 00:01:49,586
删除用户预设的方法


55
00:01:50,036 --> 00:01:51,636
托管音频单元的 App


56
00:01:51,636 --> 00:01:53,146
可以调用 saveUsePreset 方法


57
00:01:53,146 --> 00:01:55,186
将现有的状态保存至预设


58
00:01:55,186 --> 00:01:57,516
或者可以调用


59
00:01:57,516 --> 00:01:59,246
deleteUserPreset 方法


60
00:01:59,246 --> 00:02:00,686
来删除现有的预设


61
00:02:01,246 --> 00:02:02,716
音频单元通过覆盖默认


62
00:02:02,716 --> 00:02:04,526
来实现用户的逻辑


63
00:02:04,766 --> 00:02:05,966
或者也可以


64
00:02:05,966 --> 00:02:07,576
从 AUAudioUnit 基础类中


65
00:02:07,576 --> 00:02:09,256
继承默认实现


66
00:02:11,526 --> 00:02:13,096
这些默认实现


67
00:02:13,096 --> 00:02:14,336
将预设存储到


68
00:02:14,336 --> 00:02:15,866
音频单元扩展的


69
00:02:15,866 --> 00:02:17,076
Application/container 文件夹中


70
00:02:20,246 --> 00:02:21,956
你可以使用 presetState（for userPreset）


71
00:02:21,956 --> 00:02:23,946
方法来恢复


72
00:02:23,946 --> 00:02:25,926
储存在用户预设里的状态


73
00:02:26,956 --> 00:02:28,436
在父类中


74
00:02:28,436 --> 00:02:29,286
也有一个默认实现


75
00:02:29,286 --> 00:02:31,046
但它可以被覆盖


76
00:02:31,046 --> 00:02:32,686
用来适应自定义需求


77
00:02:34,136 --> 00:02:35,786
它会返回一个


78
00:02:35,786 --> 00:02:37,016
可以用来还原


79
00:02:37,016 --> 00:02:38,886
音频单元状态的词典


80
00:02:38,886 --> 00:02:40,236
并且将其存储至


81
00:02:40,236 --> 00:02:41,666
音频单元的 


82
00:02:41,666 --> 00:02:42,266
fullStateForDocument 属性


83
00:02:44,716 --> 00:02:46,906
除此之外


84
00:02:46,906 --> 00:02:48,826
我们还新增了一个属性 名为


85
00:02:48,826 --> 00:02:51,356
isLoadedInProcess


86
00:02:51,356 --> 00:02:52,746
你可以将其用来检查


87
00:02:52,746 --> 00:02:54,236
音频单元是否在进程中载入


88
00:02:55,346 --> 00:02:57,186
在进程中载入


89
00:02:57,186 --> 00:02:57,886
是 macOS 特有的性能


90
00:02:58,176 --> 00:03:00,106
主程序可以请求


91
00:03:00,106 --> 00:03:01,836
但如果音频单元没有支持


92
00:03:01,836 --> 00:03:03,656
回调行为就是


93
00:03:03,686 --> 00:03:06,386
在进程外载入音频单元


94
00:03:07,916 --> 00:03:09,836
现在 主程序和音频单元


95
00:03:09,836 --> 00:03:11,556
可以使用这个属性


96
00:03:11,556 --> 00:03:13,076
来验证操作是否成功了


97
00:03:13,076 --> 00:03:15,606
接下来 让我们实际操作一下


98
00:03:18,706 --> 00:03:20,856
现在我们看到的是


99
00:03:20,856 --> 00:03:22,466
更新后的 AUv3 样例代码


100
00:03:22,466 --> 00:03:25,026
在 macOS 和 iOS 上均可用


101
00:03:25,716 --> 00:03:27,436
在这个主 App 中


102
00:03:27,436 --> 00:03:29,436
我加载了 AUv3FilterDemo


103
00:03:30,756 --> 00:03:32,746
当我点击播放时


104
00:03:32,746 --> 00:03:35,996
我们可以听到滤波器的效果


105
00:03:35,996 --> 00:03:36,063
[背景音乐]


106
00:03:36,063 --> 00:03:38,476
我可以拖动这个曲线


107
00:03:38,476 --> 00:03:42,696
来设定滤波器的截止和共鸣


108
00:03:42,696 --> 00:03:45,406
预设部分


109
00:03:45,406 --> 00:03:46,556
在我的右侧


110
00:03:47,736 --> 00:03:49,076
我们有音频单元的


111
00:03:49,076 --> 00:03:51,256
工厂预设


112
00:03:52,076 --> 00:03:57,406
这里有热烈 欢快和突出


113
00:03:57,406 --> 00:03:59,616
另一个标签则是


114
00:03:59,616 --> 00:04:02,586
用户预设部分


115
00:04:02,586 --> 00:04:04,736
这里有我们之前保存的


116
00:04:04,736 --> 00:04:07,416
初始预设


117
00:04:07,416 --> 00:04:08,000
我也可以保存新的


118
00:04:08,516 --> 00:04:17,875
[音乐]


119
00:04:18,375 --> 00:04:21,986
我可以在两者间转换


120
00:04:21,986 --> 00:04:23,396
一旦我不再需要某个预设


121
00:04:23,396 --> 00:04:26,000
我可以直接把它删除


122
00:04:28,046 --> 00:04:29,216
这就是关于


123
00:04:29,216 --> 00:04:31,226
AUv3 所有的功能


124
00:04:31,226 --> 00:04:33,000
我鼓励你们去看一看


125
00:04:36,356 --> 00:04:38,156
总结一下


126
00:04:38,156 --> 00:04:39,656
为了补充


127
00:04:39,656 --> 00:04:41,666
工厂预设的功能


128
00:04:41,666 --> 00:04:43,276
我们为音频单元的


129
00:04:43,276 --> 00:04:44,506
增加了用户预设的支持


130
00:04:45,436 --> 00:04:46,836
这让用户可以将


131
00:04:46,836 --> 00:04:48,036
最喜欢的声音保存为预设


132
00:04:48,036 --> 00:04:50,146
并将其运用至


133
00:04:50,146 --> 00:04:51,996
每个托管音频单元的 App 中


134
00:04:53,076 --> 00:04:54,506
为了更好利用这些新的功能


135
00:04:54,506 --> 00:04:56,116
音频单元可以


136
00:04:56,116 --> 00:04:57,746
选择加入并使用


137
00:04:57,746 --> 00:04:59,286
我们提供的默认实现


138
00:04:59,286 --> 00:05:01,206
或者也可以覆盖这些方法


139
00:05:01,206 --> 00:05:03,216
实现自定义功能


140
00:05:03,986 --> 00:05:05,916
托管音频单元的 App


141
00:05:05,916 --> 00:05:07,316
向音频单元


142
00:05:07,316 --> 00:05:09,576
查询预设


143
00:05:09,576 --> 00:05:11,136
也可以通过在音频单元上


144
00:05:11,136 --> 00:05:12,206
调用正确的方法来增加新的预设


145
00:05:12,206 --> 00:05:13,426
或者删除现有的预设


146
00:05:15,036 --> 00:05:16,826
在 developer.apple.com 上


147
00:05:16,826 --> 00:05:18,086
你可以通过查看


148
00:05:18,086 --> 00:05:19,636
我们最新更新的


149
00:05:19,636 --> 00:05:21,086
样例代码和这场会议所附的


150
00:05:21,086 --> 00:05:21,966
资源来获取


151
00:05:21,966 --> 00:05:23,466
更多信息


152
00:05:24,366 --> 00:05:25,796
本场展示到此结束


153
00:05:25,976 --> 00:05:26,366
谢谢

