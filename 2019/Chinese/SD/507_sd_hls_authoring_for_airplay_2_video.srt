1
00:00:06,373 --> 00:00:08,275 line:0
你们好
我是Eryk Vershen


2
00:00:08,342 --> 00:00:11,011 line:0
我是HLS Streaming
团队的一名工程师


3
00:00:11,411 --> 00:00:15,482 line:0
我们来聊一下
AirPlay 2 Video的HLS Authoring


4
00:00:17,150 --> 00:00:20,053 line:-2
自从我们在iOS上
引入隔空播放功能以来


5
00:00:20,120 --> 00:00:24,024 line:-2
用户们都喜欢在Apple TV
使用隔空播放视频


6
00:00:24,925 --> 00:00:25,959 line:-1
今年年初


7
00:00:26,026 --> 00:00:31,798 line:-2
我们大幅度地提升了在TV
直接使用隔空播放功能的支持


8
00:00:33,166 --> 00:00:36,036 line:-1
Apple TV和AirPlay capable TV


9
00:00:36,303 --> 00:00:39,540 line:-1
都能回放高质量的视频


10
00:00:40,374 --> 00:00:43,143 line:-2
你可能记得我们有
一些特殊的要求


11
00:00:43,210 --> 00:00:46,446 line:-2
关于投影到tvOS和
Apple TV的内容


12
00:00:46,880 --> 00:00:50,284 line:-2
AirPlay capable TV
是一类新的设备


13
00:00:50,350 --> 00:00:52,452 line:-2
所以这类设备有属于
它们自己的要求标准


14
00:00:53,987 --> 00:00:55,189 line:-1
接下来会有一个简单议程


15
00:00:55,255 --> 00:00:56,990 line:-1
我会说明新的要求标准


16
00:00:57,257 --> 00:01:00,327 line:-2
以及我们对验证工具
做出的修改


17
00:01:00,394 --> 00:01:02,095 line:-1
来帮您排查问题


18
00:01:04,631 --> 00:01:05,899 line:-1
我们最近发布了


19
00:01:05,966 --> 00:01:08,802 line:-1
一个新的HLS编写规范


20
00:01:08,869 --> 00:01:12,339 line:-2
关于对AirPlay 2
额外的要求标准


21
00:01:14,708 --> 00:01:16,310 line:-1
这是一个简练的列表


22
00:01:16,376 --> 00:01:18,979 line:-2
您无需现在就全部
了解整个清单


23
00:01:19,046 --> 00:01:21,515 line:-2
我将在一个演示文档中
详细说明每一条改动


24
00:01:22,049 --> 00:01:23,750 line:-1
我们来看一下细节


25
00:01:25,419 --> 00:01:27,888 line:-2
你需要同步
不同的视频类型


26
00:01:27,955 --> 00:01:29,656 line:-1
这能让转换容易点


27
00:01:30,157 --> 00:01:33,660 line:-2
如果彩色方块在时间线上
代表不同的视频类型


28
00:01:34,628 --> 00:01:37,998 line:-2
我们要做的是
将它们排列整齐


29
00:01:38,198 --> 00:01:41,835 line:-2
推荐你使用
毫秒级精度以上的标准


30
00:01:42,636 --> 00:01:47,174 line:-2
以及你的视频片段应该以
IDR帧来开始


31
00:01:48,375 --> 00:01:51,478 line:-2
你也要避免
不连续的变化


32
00:01:51,678 --> 00:01:56,149 line:-2
比如 不要在
HEVC和H.264以及


33
00:01:56,216 --> 00:01:58,485 line:-2
AAC和Dolby Digital
之间切换


34
00:01:59,419 --> 00:02:03,857 line:-2
因为这些格式不能在iOS
和Apple TV无缝转换


35
00:02:04,825 --> 00:02:07,528 line:-1
你可以小心地调整帧率


36
00:02:07,594 --> 00:02:10,497 line:-2
不要在
每秒25帧和30帧之间转换


37
00:02:13,700 --> 00:02:17,704 line:-2
如果你要每个编解码器都能
很好地支持每种格式


38
00:02:18,105 --> 00:02:20,941 line:-2
而这些视频格式使用的
一直是最开始的编解码器


39
00:02:21,241 --> 00:02:22,609 line:-1
所以 特别是


40
00:02:22,676 --> 00:02:26,180 line:-2
不要只在低分辨率视频
中使用H.264


41
00:02:26,246 --> 00:02:28,782 line:-1
在高分辨率视频中只使用HEVC


42
00:02:29,116 --> 00:02:31,718 line:-2
虽然在其他设备上起作用
但这里不行


43
00:02:32,553 --> 00:02:35,122 line:-2
你应该使用
I-frame方差


44
00:02:35,189 --> 00:02:38,492 line:-2
它们让快进 倒带
查询更有效率


45
00:02:38,792 --> 00:02:41,361 line:-2
因为此类设备
不太会切换编解码器


46
00:02:41,428 --> 00:02:45,699 line:-2
你需要使用一系列I-frame方差
来适配一般视频的编解码器


47
00:02:48,569 --> 00:02:50,771 line:-1
下面是关于编码的要求


48
00:02:50,838 --> 00:02:54,541 line:-2
并不只针对AirPlay 2
但我们要了解这些要求


49
00:02:55,542 --> 00:02:59,847 line:-2
一般的加密标准
推荐使用10%部分加密


50
00:03:00,047 --> 00:03:04,218 line:-2
我们需要使用FairPlay
其他的编码可能无法工作


51
00:03:05,252 --> 00:03:07,754 line:-2
对于样本加密
有两种方法


52
00:03:08,155 --> 00:03:11,058 line:-1
CMAF使用了一个senc box


53
00:03:11,124 --> 00:03:16,930 line:-2
ISO则基于媒体格式
使用一对saio box和saiz box


54
00:03:17,130 --> 00:03:20,033 line:-2
我们推荐第二种方式
但你可以使用两者


55
00:03:21,768 --> 00:03:24,137 line:-1
最后 我们讲下其他要求


56
00:03:24,404 --> 00:03:26,473 line:-1
如果你要使用HDR内容


57
00:03:26,540 --> 00:03:29,443 line:-2
最好的方式是
提供多种格式类型


58
00:03:29,510 --> 00:03:31,979 line:-1
比如Dolby Vision和HDR 10


59
00:03:32,045 --> 00:03:34,848 line:-2
因为TV可能只支持
其中一种格式


60
00:03:35,916 --> 00:03:38,385 line:-1
使用WebVTT添加字幕


61
00:03:39,019 --> 00:03:42,856 line:-2
所有网络内容 我们都推荐
都使用MIME格式


62
00:03:43,056 --> 00:03:45,292 line:-2
下面我们来讲下具体
细节


63
00:03:46,493 --> 00:03:49,830 line:-2
我们使用MIME格式
发送HLS播放列表很长时间了


64
00:03:50,364 --> 00:03:52,833 line:-2
关于视频和音频的
MIME格式推荐


65
00:03:52,900 --> 00:03:54,501 line:-1
可能是你想要了解的


66
00:03:55,202 --> 00:03:58,105 line:-2
请留意 对于WebVTT
我们使用text/plain


67
00:03:58,172 --> 00:04:02,075 line:-2
尽管WebVTT文档
推荐text/VTT格式


68
00:04:02,476 --> 00:04:04,511 line:-1
然而text VTT格式


69
00:04:04,578 --> 00:04:09,583 line:-2
并不是由IANA注册
也可能不被一些客户端兼容


70
00:04:09,650 --> 00:04:12,119 line:-1
所以要使用text/plain格式


71
00:04:14,488 --> 00:04:17,257 line:-2
下面是
一些不太常用的MIME类型清单


72
00:04:17,591 --> 00:04:21,295 line:-2
清单的最后两个
不被AirPlay 2兼容


73
00:04:21,361 --> 00:04:23,463 line:-2
在这里列出
是因为我们推荐MIME格式


74
00:04:23,530 --> 00:04:26,166 line:-2
包括所有网站内容
而不仅仅是AirPlay 2


75
00:04:28,936 --> 00:04:31,338 line:-2
现在我们来看看
如何检测你的流媒体


76
00:04:33,707 --> 00:04:34,741 line:-1
我们记得有两个


77
00:04:34,808 --> 00:04:37,244 line:-1
工具来验证HLS


78
00:04:37,611 --> 00:04:39,346 line:-1
这些工具各有所长


79
00:04:39,847 --> 00:04:43,684 line:-2
Mediastreamvalidator
的特色是检测HLS是否符合标准


80
00:04:44,017 --> 00:04:45,619 line:-1
HLSreport则是


81
00:04:45,686 --> 00:04:48,288 line:-1
检测是否符合编写规范标准


82
00:04:48,622 --> 00:04:50,891 line:-1
你应该要始终使用这两个工具


83
00:04:51,225 --> 00:04:53,994 line:-2
我建议你写个脚本
使用这两个工具一并测试


84
00:04:55,529 --> 00:04:58,265 line:-2
至于HLSreport
我们做了重要的修改


85
00:04:58,765 --> 00:05:02,536 line:-2
以前你需要使用“-os”选项
测试多次


86
00:05:02,603 --> 00:05:06,173 line:-2
如果你想要检查iOS和tvOS
的规则的话


87
00:05:06,740 --> 00:05:09,476 line:-2
现在 默认情况下
它可以检测所有的规则


88
00:05:09,543 --> 00:05:11,578 line:-1
包括AirPlay 2的规则


89
00:05:12,479 --> 00:05:15,516 line:-2
设置选项的规则
来修改你的检测的测试


90
00:05:15,582 --> 00:05:17,684 line:-1
但通常你们不必使用它


91
00:05:18,185 --> 00:05:21,855 line:-2
当OS选项还在工作时
你需要停止使用它


92
00:05:23,991 --> 00:05:27,561 line:-2
我们来看下HLSreport
变化后的输出


93
00:05:28,662 --> 00:05:33,066 line:-2
请留意标题栏
所有的规则标准都被检测过了


94
00:05:35,169 --> 00:05:39,072 line:-2
一部分规则现在则被
分类到各个规则集


95
00:05:39,706 --> 00:05:41,775 line:-1
我们有通用的要求说明


96
00:05:42,109 --> 00:05:45,078 line:-2
每个规则集有Must Fix
和Should Fix


97
00:05:45,145 --> 00:05:46,380 line:-1
两个分项


98
00:05:48,015 --> 00:05:51,718 line:-2
在输出的最底部
有iOS要求说明


99
00:05:52,786 --> 00:05:54,888 line:-1
请留意规则10


100
00:05:54,955 --> 00:05:58,458 line:-2
上面的最后一则通规
被标记为Should Fix


101
00:05:59,026 --> 00:06:04,298 line:-2
然而在AirPlay 2
相同的规则是Must Fix


102
00:06:06,500 --> 00:06:09,636 line:-2
如果某个部分或
子部分没有违规


103
00:06:09,703 --> 00:06:11,839 line:-2
该部分或
子部分会被放过


104
00:06:12,206 --> 00:06:15,776 line:-2
比如 针对AirPlay 2
这个流媒体没有Should Fix


105
00:06:18,045 --> 00:06:19,880 line:-1
最需要留意的是


106
00:06:19,947 --> 00:06:23,050 line:-2
针对AirPlay 2的设备
我们添加了新的需求说明


107
00:06:23,517 --> 00:06:25,118 line:-1
记得使用HLSreport


108
00:06:25,185 --> 00:06:27,788 line:-2
这样你就可以
检测是否符合编写规范标准


109
00:06:27,988 --> 00:06:32,125 line:-2
HLSreport现在
可以检测默认设置中的所有规则


110
00:06:34,127 --> 00:06:37,598 line:-2
以上就是演讲507的所有内容
如你想要了解更多信息


111
00:06:37,865 --> 00:06:40,200 line:-2
你可通过链接
查看编写规范


112
00:06:40,267 --> 00:06:43,437 line:-2
以及工具
和HLS的其他信息


113
00:06:44,338 --> 00:06:45,639 line:-1
感谢聆听


114
00:06:46,139 --> 00:06:47,774 line:-1
祝你接下来的会议行程愉快

